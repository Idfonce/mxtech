<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Savings Goals Tracker</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            max-width: 1000px;
            margin: 0 auto;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        /* Header and Navigation */
        header {
            background-color: #2c3e50;
            color: white;
            padding: 20px;
            border-radius: 0 0 12px 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        
        h1 {
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        nav {
            display: flex;
            gap: 5px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        
        .nav-btn {
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .nav-btn:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        .nav-btn.active {
            background-color: #3498db;
        }
        
        /* Main Content Area */
        .container {
            flex: 1;
            padding: 30px 20px;
        }
        
        .page {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .page.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Card Styling */
        .card {
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            margin-bottom: 20px;
        }
        
        h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* Yellow Background for Create Goal Page */
        #create-goal-page {
            background-color: #fff9e6;
            padding: 20px;
            border-radius: 12px;
            margin-top: 10px;
        }
        
        /* Form Styling */
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #34495e;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #3498db;
        }
        
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        button:hover {
            background-color: #2980b9;
        }
        
        button.secondary {
            background-color: #7f8c8d;
        }
        
        button.secondary:hover {
            background-color: #727b7c;
        }
        
        button.success {
            background-color: #27ae60;
        }
        
        button.success:hover {
            background-color: #219653;
        }
        
        /* Goals List */
        .goals-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .goal-card {
            border-radius: 10px;
            padding: 20px;
            background-color: white;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            border-left: 5px solid #3498db;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .goal-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
        }
        
        .goal-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 8px;
        }
        
        .goal-description {
            color: #7f8c8d;
            margin-bottom: 15px;
            font-size: 0.95rem;
        }
        
        .goal-amount {
            font-size: 1.1rem;
            font-weight: 600;
            color: #27ae60;
            margin-bottom: 15px;
        }
        
        /* Progress Bar */
        .progress-container {
            margin-top: 15px;
        }
        
        .progress-bar {
            height: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 8px;
        }
        
        .progress-fill {
            height: 100%;
            background-color: #2ecc71;
            border-radius: 5px;
            transition: width 0.5s ease;
        }
        
        .progress-text {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: #7f8c8d;
        }
        
        /* Transactions */
        .transaction-list {
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 10px;
        }
        
        .transaction-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .transaction-item:last-child {
            border-bottom: none;
        }
        
        .transaction-date {
            color: #7f8c8d;
            font-size: 0.85rem;
        }
        
        .transaction-amount {
            font-weight: 600;
            color: #27ae60;
        }
        
        .transaction-note {
            font-size: 0.9rem;
            color: #555;
            margin-top: 5px;
        }
        
        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #7f8c8d;
        }
        
        .empty-state i {
            font-size: 4rem;
            margin-bottom: 20px;
            color: #bdc3c7;
            opacity: 0.7;
        }
        
        .empty-state h3 {
            margin-bottom: 10px;
            color: #7f8c8d;
        }
        
        /* Footer */
        footer {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
            font-size: 0.9rem;
            border-top: 1px solid #e0e0e0;
            margin-top: 20px;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                align-items: flex-start;
            }
            
            nav {
                width: 100%;
                justify-content: space-between;
                margin-top: 15px;
            }
            
            .nav-btn {
                flex: 1;
                justify-content: center;
                padding: 10px 5px;
                font-size: 0.85rem;
            }
            
            .goals-list {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            
            .container {
                padding: 20px 15px;
            }
        }
        
        /* Summary Stats */
        .stats-container {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .stat-card {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            flex: 1;
            min-width: 180px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.05);
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #2c3e50;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #7f8c8d;
            margin-top: 5px;
        }
        
        /* Goal Actions */
        .goal-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .goal-actions button {
            flex: 1;
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <h1><i class="fas fa-piggy-bank"></i> Savings Goals Tracker</h1>
            <nav>
                <button class="nav-btn active" data-page="dashboard">
                    <i class="fas fa-home"></i> Dashboard
                </button>
                <button class="nav-btn" data-page="create-goal">
                    <i class="fas fa-plus-circle"></i> Create Goal
                </button>
                <button class="nav-btn" data-page="my-goals">
                    <i class="fas fa-bullseye"></i> My Goals
                </button>
                <button class="nav-btn" data-page="transactions">
                    <i class="fas fa-history"></i> Transactions
                </button>
            </nav>
        </div>
    </header>
    
    <div class="container">
        <!-- Dashboard Page -->
        <div id="dashboard-page" class="page active">
            <div class="card">
                <h2><i class="fas fa-tachometer-alt"></i> Dashboard Overview</h2>
                
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-value" id="total-goals">0</div>
                        <div class="stat-label">Total Goals</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="total-saved">Tzs. 0</div>
                        <div class="stat-label">Total Saved</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="total-target">Tzs. 0</div>
                        <div class="stat-label">Total Target</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="avg-progress">0%</div>
                        <div class="stat-label">Average Progress</div>
                    </div>
                </div>
                
                <div class="empty-state" id="dashboard-empty">
                    <i class="fas fa-chart-line"></i>
                    <h3>No savings goals yet</h3>
                    <p>Create your first savings goal to see your dashboard statistics</p>
                    <button class="success" style="margin-top: 20px;" data-page="create-goal">
                        <i class="fas fa-plus-circle"></i> Create Your First Goal
                    </button>
                </div>
                
                <div id="recent-goals" style="display: none;">
                    <h3 style="margin-top: 30px;">Recent Goals</h3>
                    <div class="goals-list" id="dashboard-goals">
                        <!-- Recent goals will appear here -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Create Goal Page (with yellow background) -->
        <div id="create-goal-page" class="page">
            <div class="card">
                <h2><i class="fas fa-plus-circle"></i> Create a New Savings Goal</h2>
                
                <div class="form-group">
                    <label for="goal-name">What are you saving for? *</label>
                    <input type="text" id="goal-name" placeholder="e.g., New Smartphone, Vacation, Emergency Fund">
                </div>
                
                <div class="form-group">
                    <label for="goal-description">Description</label>
                    <textarea id="goal-description" placeholder="Describe your goal... (optional)"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="goal-target">Target Amount (Tzs.) *</label>
                    <input type="number" id="goal-target" placeholder="e.g., 1500000" min="1">
                </div>
                
                <div class="form-group">
                    <label for="goal-category">Category (optional)</label>
                    <select id="goal-category">
                        <option value="">Select a category</option>
                        <option value="electronics">Electronics</option>
                        <option value="travel">Travel</option>
                        <option value="education">Education</option>
                        <option value="home">Home</option>
                        <option value="vehicle">Vehicle</option>
                        <option value="emergency">Emergency Fund</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="goal-deadline">Target Date (optional)</label>
                    <input type="date" id="goal-deadline">
                </div>
                
                <div class="goal-actions">
                    <button class="secondary" data-page="dashboard">
                        <i class="fas fa-arrow-left"></i> Back to Dashboard
                    </button>
                    <button id="create-goal-btn" class="success">
                        <i class="fas fa-check"></i> Create Savings Goal
                    </button>
                </div>
            </div>
        </div>
        
        <!-- My Goals Page -->
        <div id="my-goals-page" class="page">
            <div class="card">
                <h2><i class="fas fa-bullseye"></i> My Savings Goals</h2>
                
                <div id="goals-container" class="goals-list">
                    <!-- Goals will be dynamically added here -->
                    <div class="empty-state" id="empty-goals">
                        <i class="fas fa-bullseye"></i>
                        <h3>No savings goals yet</h3>
                        <p>Create your first savings goal to get started</p>
                        <button class="success" style="margin-top: 20px;" data-page="create-goal">
                            <i class="fas fa-plus-circle"></i> Create a Goal
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Transactions Page -->
        <div id="transactions-page" class="page">
            <div class="card">
                <h2><i class="fas fa-history"></i> Recent Transactions</h2>
                
                <div class="form-group">
                    <label for="filter-goal">Filter by Goal</label>
                    <select id="filter-goal">
                        <option value="all">All Goals</option>
                        <!-- Goal options will be added dynamically -->
                    </select>
                </div>
                
                <div id="transactions-container">
                    <div class="empty-state" id="empty-transactions">
                        <i class="fas fa-exchange-alt"></i>
                        <h3>No transactions yet</h3>
                        <p>Add savings to your goals to see transactions here</p>
                        <button class="success" style="margin-top: 20px;" data-page="my-goals">
                            <i class="fas fa-bullseye"></i> View My Goals
                        </button>
                    </div>
                    
                    <div class="transaction-list" id="transactions-list" style="display: none;">
                        <!-- Transactions will be dynamically added here -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Goal Details Modal -->
        <div id="goal-details-modal" class="page" style="display: none;">
            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2 id="selected-goal-title"></h2>
                    <button class="secondary" onclick="closeGoalDetails()">
                        <i class="fas fa-times"></i> Close
                    </button>
                </div>
                
                <div id="selected-goal-content">
                    <!-- Goal details will be dynamically added here -->
                </div>
            </div>
        </div>
    </div>
    
    <footer>
        <p>Savings Goals Tracker &copy; 2023 | Track your financial goals with ease</p>
    </footer>

    <script>
        // Sample data for demonstration
        let goals = [
            {
                id: 1,
                name: "New Smartphone",
                description: "Samsung Galaxy S23 with 256GB storage",
                category: "electronics",
                targetAmount: 1500000,
                currentAmount: 503100,
                deadline: "2026-06-30",
                createdAt: "2025-07-03",
                transactions: [
                    { id: 1, date: "28 Dec 2026 22:29", amount: 2925, note: "Daily savings" },
                    { id: 2, date: "27 Dec 2026 21:15", amount: 2925, note: "Daily savings" },
                    { id: 3, date: "26 Dec 2026 19:45", amount: 5000, note: "Extra savings" }
                ]
            },
            {
                id: 2,
                name: "Zanzibar Vacation",
                description: "One week vacation in Zanzibar with flights and hotel",
                category: "travel",
                targetAmount: 800000,
                currentAmount: 250000,
                deadline: "2026-03-15",
                createdAt: "2025-10-10",
                transactions: [
                    { id: 4, date: "25 Dec 2026 14:20", amount: 50000, note: "Monthly savings" },
                    { id: 5, date: "15 Dec 2026 10:05", amount: 100000, note: "Bonus added" },
                    { id: 6, date: "01 Dec 2026 09:30", amount: 100000, note: "Monthly savings" }
                ]
            },
            {
                id: 3,
                name: "Emergency Fund",
                description: "3 months of living expenses for emergencies",
                category: "emergency",
                targetAmount: 3000000,
                currentAmount: 750000,
                deadline: "2027-12-31",
                createdAt: "2025-01-15",
                transactions: [
                    { id: 7, date: "20 Dec 2026 16:45", amount: 50000, note: "Monthly contribution" },
                    { id: 8, date: "10 Dec 2026 11:20", amount: 100000, note: "Extra from side job" }
                ]
            }
        ];
        
        // DOM Elements
        const pages = document.querySelectorAll('.page');
        const navBtns = document.querySelectorAll('.nav-btn');
        const goalsContainer = document.getElementById('goals-container');
        const emptyGoals = document.getElementById('empty-goals');
        const transactionsList = document.getElementById('transactions-list');
        const emptyTransactions = document.getElementById('empty-transactions');
        const dashboardEmpty = document.getElementById('dashboard-empty');
        const dashboardGoals = document.getElementById('dashboard-goals');
        const recentGoals = document.getElementById('recent-goals');
        const filterGoalSelect = document.getElementById('filter-goal');
        
        // Dashboard stats elements
        const totalGoalsEl = document.getElementById('total-goals');
        const totalSavedEl = document.getElementById('total-saved');
        const totalTargetEl = document.getElementById('total-target');
        const avgProgressEl = document.getElementById('avg-progress');
        
        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Set up navigation
            setupNavigation();
            
            // Load initial data
            updateDashboard();
            renderGoals();
            updateTransactionsList();
            populateGoalFilter();
            
            // Create goal button event listener
            document.getElementById('create-goal-btn').addEventListener('click', createNewGoal);
            
            // Set minimum date for deadline to today
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('goal-deadline').min = today;
        });
        
        // Set up navigation between pages
        function setupNavigation() {
            navBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const pageId = this.getAttribute('data-page');
                    navigateToPage(pageId);
                });
            });
            
            // Also handle buttons with data-page attribute
            document.addEventListener('click', function(e) {
                if (e.target.closest('button[data-page]')) {
                    const btn = e.target.closest('button[data-page]');
                    const pageId = btn.getAttribute('data-page');
                    navigateToPage(pageId);
                }
            });
        }
        
        // Navigate to a specific page
        function navigateToPage(pageId) {
            // Hide all pages
            pages.forEach(page => {
                page.classList.remove('active');
            });
            
            // Show selected page
            document.getElementById(`${pageId}-page`).classList.add('active');
            
            // Update active navigation button
            navBtns.forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('data-page') === pageId) {
                    btn.classList.add('active');
                }
            });
            
            // Update content if needed
            if (pageId === 'dashboard') {
                updateDashboard();
            } else if (pageId === 'my-goals') {
                renderGoals();
            } else if (pageId === 'transactions') {
                updateTransactionsList();
            }
        }
        
        // Update dashboard statistics
        function updateDashboard() {
            if (goals.length === 0) {
                dashboardEmpty.style.display = 'block';
                recentGoals.style.display = 'none';
                return;
            }
            
            dashboardEmpty.style.display = 'none';
            recentGoals.style.display = 'block';
            
            // Calculate stats
            const totalGoals = goals.length;
            const totalSaved = goals.reduce((sum, goal) => sum + goal.currentAmount, 0);
            const totalTarget = goals.reduce((sum, goal) => sum + goal.targetAmount, 0);
            const avgProgress = goals.length > 0 
                ? Math.round(goals.reduce((sum, goal) => sum + (goal.currentAmount / goal.targetAmount * 100), 0) / goals.length) 
                : 0;
            
            // Update stats display
            totalGoalsEl.textContent = totalGoals;
            totalSavedEl.textContent = formatCurrency(totalSaved);
            totalTargetEl.textContent = formatCurrency(totalTarget);
            avgProgressEl.textContent = `${avgProgress}%`;
            
            // Show recent goals (up to 4)
            dashboardGoals.innerHTML = '';
            const recentGoalsToShow = goals.slice(0, 4);
            
            recentGoalsToShow.forEach(goal => {
                const progressPercentage = Math.min(Math.round((goal.currentAmount / goal.targetAmount) * 100), 100);
                
                const goalCard = document.createElement('div');
                goalCard.className = 'goal-card';
                goalCard.innerHTML = `
                    <div class="goal-title">${goal.name}</div>
                    <div class="goal-description">${goal.description.substring(0, 60)}${goal.description.length > 60 ? '...' : ''}</div>
                    <div class="goal-amount">${formatCurrency(goal.currentAmount)} / ${formatCurrency(goal.targetAmount)}</div>
                    <div class="progress-container">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${progressPercentage}%"></div>
                        </div>
                        <div class="progress-text">
                            <span>${progressPercentage}%</span>
                        </div>
                    </div>
                    <button onclick="viewGoalDetails(${goal.id})" style="margin-top: 15px; width: 100%;">
                        <i class="fas fa-eye"></i> View Details
                    </button>
                `;
                
                dashboardGoals.appendChild(goalCard);
            });
        }
        
        // Render all goals on the My Goals page
        function renderGoals() {
            goalsContainer.innerHTML = '';
            
            if (goals.length === 0) {
                emptyGoals.style.display = 'block';
                return;
            }
            
            emptyGoals.style.display = 'none';
            
            goals.forEach(goal => {
                const progressPercentage = Math.min(Math.round((goal.currentAmount / goal.targetAmount) * 100), 100);
                const daysLeft = goal.deadline ? calculateDaysLeft(goal.deadline) : null;
                
                const goalCard = document.createElement('div');
                goalCard.className = 'goal-card';
                goalCard.innerHTML = `
                    <div class="goal-title">${goal.name}</div>
                    <div class="goal-description">${goal.description}</div>
                    <div class="goal-amount">Saved: ${formatCurrency(goal.currentAmount)} / ${formatCurrency(goal.targetAmount)}</div>
                    <div class="progress-container">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${progressPercentage}%"></div>
                        </div>
                        <div class="progress-text">
                            <span>${progressPercentage}% complete</span>
                            <span>${formatCurrency(goal.targetAmount - goal.currentAmount)} to go</span>
                        </div>
                    </div>
                    ${daysLeft !== null ? `<div style="margin-top: 10px; font-size: 0.9rem; color: ${daysLeft < 30 ? '#e74c3c' : '#7f8c8d'}">
                        <i class="far fa-calendar"></i> ${daysLeft} days left
                    </div>` : ''}
                    <div class="goal-actions">
                        <button onclick="viewGoalDetails(${goal.id})" style="flex: 2;">
                            <i class="fas fa-eye"></i> View Details
                        </button>
                        <button onclick="addToGoal(${goal.id})" class="success" style="flex: 1;">
                            <i class="fas fa-plus"></i> Add
                        </button>
                    </div>
                `;
                
                goalsContainer.appendChild(goalCard);
            });
        }
        
        // Create a new goal
        function createNewGoal() {
            const nameInput = document.getElementById('goal-name');
            const descInput = document.getElementById('goal-description');
            const targetInput = document.getElementById('goal-target');
            const categoryInput = document.getElementById('goal-category');
            const deadlineInput = document.getElementById('goal-deadline');
            
            if (!nameInput.value.trim() || !targetInput.value || targetInput.value <= 0) {
                alert('Please enter a valid goal name and target amount');
                return;
            }
            
            const newGoal = {
                id: goals.length > 0 ? Math.max(...goals.map(g => g.id)) + 1 : 1,
                name: nameInput.value.trim(),
                description: descInput.value.trim() || 'No description',
                category: categoryInput.value || 'other',
                targetAmount: parseInt(targetInput.value),
                currentAmount: 0,
                deadline: deadlineInput.value || null,
                createdAt: new Date().toISOString().split('T')[0],
                transactions: []
            };
            
            goals.push(newGoal);
            
            // Clear form
            nameInput.value = '';
            descInput.value = '';
            targetInput.value = '';
            categoryInput.value = '';
            deadlineInput.value = '';
            
            // Update UI
            updateDashboard();
            renderGoals();
            populateGoalFilter();
            
            // Navigate to the new goal
            navigateToPage('my-goals');
            
            // Show success message
            alert(`Successfully created "${newGoal.name}" goal!`);
        }
        
        // View goal details in modal
        function viewGoalDetails(goalId) {
            const goal = goals.find(g => g.id === goalId);
            if (!goal) return;
            
            // Show the goal details modal
            document.getElementById('goal-details-modal').style.display = 'block';
            
            // Hide other pages
            pages.forEach(page => {
                if (page.id !== 'goal-details-modal') {
                    page.classList.remove('active');
                }
            });
            
            // Update modal content
            const progressPercentage = Math.min(Math.round((goal.currentAmount / goal.targetAmount) * 100), 100);
            const daysLeft = goal.deadline ? calculateDaysLeft(goal.deadline) : null;
            
            // Generate transactions list
            let transactionsHTML = '';
            if (goal.transactions.length > 0) {
                goal.transactions.forEach(transaction => {
                    transactionsHTML += `
                        <div class="transaction-item">
                            <div>
                                <div>${transaction.date}</div>
                                <div class="transaction-note">${transaction.note}</div>
                            </div>
                            <div class="transaction-amount">+ ${formatCurrency(transaction.amount)}</div>
                        </div>
                    `;
                });
            } else {
                transactionsHTML = '<div class="empty-state" style="padding: 30px 0;"><p>No transactions yet. Add your first savings deposit!</p></div>';
            }
            
            // Add category icon
            const categoryIcons = {
                electronics: 'fas fa-laptop',
                travel: 'fas fa-plane',
                education: 'fas fa-graduation-cap',
                home: 'fas fa-home',
                vehicle: 'fas fa-car',
                emergency: 'fas fa-shield-alt',
                other: 'fas fa-star'
            };
            
            const categoryIcon = categoryIcons[goal.category] || 'fas fa-star';
            
            document.getElementById('selected-goal-title').innerHTML = `
                <i class="${categoryIcon}"></i> ${goal.name}
            `;
            
            document.getElementById('selected-goal-content').innerHTML = `
                <div class="goal-description" style="margin-bottom: 20px;">${goal.description}</div>
                
                <div style="display: flex; gap: 20px; flex-wrap: wrap; margin-bottom: 25px;">
                    <div>
                        <div style="font-weight: 600; color: #7f8c8d;">Target Amount</div>
                        <div class="goal-amount" style="font-size: 1.3rem;">${formatCurrency(goal.targetAmount)}</div>
                    </div>
                    <div>
                        <div style="font-weight: 600; color: #7f8c8d;">Currently Saved</div>
                        <div class="goal-amount" style="font-size: 1.3rem;">${formatCurrency(goal.currentAmount)}</div>
                    </div>
                    ${goal.deadline ? `
                    <div>
                        <div style="font-weight: 600; color: #7f8c8d;">Target Date</div>
                        <div style="font-size: 1.1rem;">${formatDate(goal.deadline)}</div>
                    </div>
                    ` : ''}
                </div>
                
                <div class="progress-container" style="margin-bottom: 30px;">
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${progressPercentage}%"></div>
                    </div>
                    <div class="progress-text">
                        <span>${progressPercentage}% complete</span>
                        <span>${formatCurrency(goal.currentAmount)} saved of ${formatCurrency(goal.targetAmount)}</span>
                    </div>
                    ${daysLeft !== null ? `
                    <div style="margin-top: 10px; text-align: center; font-size: 0.9rem; color: ${daysLeft < 30 ? '#e74c3c' : '#7f8c8d'}">
                        <i class="far fa-calendar"></i> ${daysLeft} days left to reach your goal
                    </div>
                    ` : ''}
                </div>
                
                <div style="margin-top: 30px;">
                    <h3 style="font-size: 1.2rem; margin-bottom: 15px;">Add Savings</h3>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <input type="number" id="transaction-amount-${goal.id}" placeholder="Amount to add" style="flex: 1;">
                        <input type="text" id="transaction-note-${goal.id}" placeholder="Note (optional)" style="flex: 1;">
                        <button onclick="addTransaction(${goal.id})" class="success">
                            <i class="fas fa-plus"></i> Add
                        </button>
                    </div>
                </div>
                
                <div style="margin-top: 40px;">
                    <h3 style="font-size: 1.2rem; margin-bottom: 15px;">Transaction History</h3>
                    <div class="transaction-list">
                        ${transactionsHTML}
                    </div>
                </div>
            `;
        }
        
        // Close goal details modal
        function closeGoalDetails() {
            document.getElementById('goal-details-modal').style.display = 'none';
            navigateToPage('my-goals');
        }
        
        // Quick add to goal from My Goals page
        function addToGoal(goalId) {
            const amount = prompt(`How much would you like to add to this goal? (Tzs.)`);
            
            if (!amount || isNaN(amount) || amount <= 0) {
                alert('Please enter a valid amount');
                return;
            }
            
            addTransaction(goalId, parseInt(amount), "Manual addition");
        }
        
        // Add a transaction to a goal
        function addTransaction(goalId, amount, note) {
            const goal = goals.find(g => g.id === goalId);
            if (!goal) return;
            
            // If amount is not provided, get it from the input
            if (!amount) {
                const amountInput = document.getElementById(`transaction-amount-${goalId}`);
                const noteInput = document.getElementById(`transaction-note-${goalId}`);
                
                amount = parseInt(amountInput.value);
                note = noteInput.value.trim() || "Savings deposit";
                
                if (!amount || amount <= 0) {
                    alert('Please enter a valid amount');
                    return;
                }
                
                // Clear inputs
                amountInput.value = '';
                noteInput.value = '';
            }
            
            // Add transaction
            const now = new Date();
            const transactionDate = now.toLocaleDateString('en-GB', {
                day: 'numeric',
                month: 'short',
                year: 'numeric'
            }) + ' ' + now.toLocaleTimeString('en-GB', {
                hour: '2-digit',
                minute: '2-digit'
            });
            
            const newTransaction = {
                id: goal.transactions.length > 0 ? Math.max(...goal.transactions.map(t => t.id)) + 1 : 1,
                date: transactionDate,
                amount: amount,
                note: note
            };
            
            goal.transactions.unshift(newTransaction);
            
            // Update current amount
            goal.currentAmount += amount;
            
            // Update the UI
            updateDashboard();
            renderGoals();
            updateTransactionsList();
            
            // If we're in the goal details modal, update it
            if (document.getElementById('goal-details-modal').style.display === 'block') {
                viewGoalDetails(goalId);
            }
            
            // Show success message
            alert(`Successfully added ${formatCurrency(amount)} to your "${goal.name}" goal!`);
        }
        
        // Update transactions list
        function updateTransactionsList() {
            const selectedGoalId = filterGoalSelect.value;
            let allTransactions = [];
            
            // Get all transactions
            goals.forEach(goal => {
                if (selectedGoalId === 'all' || selectedGoalId === goal.id.toString()) {
                    goal.transactions.forEach(transaction => {
                        allTransactions.push({
                            ...transaction,
                            goalName: goal.name,
                            goalId: goal.id
                        });
                    });
                }
            });
            
            // Sort by date (newest first)
            allTransactions.sort((a, b) => {
                // Simple date comparison - in a real app you'd parse dates properly
                return b.id - a.id;
            });
            
            // Update UI
            if (allTransactions.length === 0) {
                emptyTransactions.style.display = 'block';
                transactionsList.style.display = 'none';
                return;
            }
            
            emptyTransactions.style.display = 'none';
            transactionsList.style.display = 'block';
            
            // Display transactions
            transactionsList.innerHTML = '';
            allTransactions.forEach(transaction => {
                const transactionItem = document.createElement('div');
                transactionItem.className = 'transaction-item';
                transactionItem.innerHTML = `
                    <div>
                        <div style="font-weight: 600;">${transaction.goalName}</div>
                        <div class="transaction-date">${transaction.date}</div>
                        <div class="transaction-note">${transaction.note}</div>
                    </div>
                    <div>
                        <div class="transaction-amount">+ ${formatCurrency(transaction.amount)}</div>
                        <button onclick="viewGoalDetails(${transaction.goalId})" style="margin-top: 5px; padding: 5px 10px; font-size: 0.8rem;">
                            <i class="fas fa-eye"></i> View Goal
                        </button>
                    </div>
                `;
                transactionsList.appendChild(transactionItem);
            });
        }
        
        // Populate the goal filter dropdown
        function populateGoalFilter() {
            filterGoalSelect.innerHTML = '<option value="all">All Goals</option>';
            
            goals.forEach(goal => {
                const option = document.createElement('option');
                option.value = goal.id;
                option.textContent = goal.name;
                filterGoalSelect.appendChild(option);
            });
            
            // Add event listener for filter change
            filterGoalSelect.addEventListener('change', updateTransactionsList);
        }
        
        // Helper functions
        function formatCurrency(amount) {
            return `Tzs. ${amount.toLocaleString('en-US')}`;
        }
        
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-GB', {
                day: 'numeric',
                month: 'short',
                year: 'numeric'
            });
        }
        
        function calculateDaysLeft(deadline) {
            const today = new Date();
            const deadlineDate = new Date(deadline);
            const diffTime = deadlineDate - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            return diffDays > 0 ? diffDays : 0;
        }
    </script>
</body>
  </html>
